
        match /users/{userId} {
          allow read: if request.auth.uid == userId || get(/databases/$(database)/documents/users/$(request.auth.uid)).data.isAdmin == true;
          allow create: if request.auth.uid == userId; // For initial profile creation
          // Only admins can update these sensitive fields
          allow update: if get(/databases/$(database)/documents/users/$(request.auth.uid)).data.isAdmin == true;
        }
        
    